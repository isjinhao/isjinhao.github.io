<!-- build time:Mon Dec 30 2019 21:34:07 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><style>.pace .pace-progress{background:#1E92FB;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1E92FB,0 0 5px #1E92FB}.pace .pace-activity{border-top-color:#1E92FB;border-left-color:#1E92FB}</style><meta name="theme-color" content="#222"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=6.7.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon16x16.ico?v=6.7.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32x32.ico?v=6.7.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16x16.ico?v=6.7.0"><link rel="mask-icon" href="/images/favicon16x16.ico?v=6.7.0" color="#222"><link rel="manifest" href="/images/favicon16x16.ico"><meta name="msapplication-config" content="/images/favicon16x16.ico"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"6.7.0",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement(o),n=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"28dbf854"}),daovoice("update")</script><meta name="description" content="字节码文件结构使用javap-verbose命令分析一个字节码文件时将会分析该字节码文件的魔数、版本号、常量池、类信息、类的构造方法、类中的方法信息、类变量与成员变量等信息。我们先来编写一个非常简单的类。12public interface MyInterface1 &amp;#123;&amp;#125;反编译指令：javap，参数：-p、-verbose。12345public class MyTest1 i"><meta name="keywords" content="Java,JVM"><meta property="og:type" content="article"><meta property="og:title" content="03.02-JVM-字节码"><meta property="og:url" content="https://isjinhao.github.io/posts/20964.html/index.html"><meta property="og:site_name" content="ISJINHAO"><meta property="og:description" content="字节码文件结构使用javap-verbose命令分析一个字节码文件时将会分析该字节码文件的魔数、版本号、常量池、类信息、类的构造方法、类中的方法信息、类变量与成员变量等信息。我们先来编写一个非常简单的类。12public interface MyInterface1 &amp;#123;&amp;#125;反编译指令：javap，参数：-p、-verbose。12345public class MyTest1 i"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/ccc5f00c-1a6d-44a8-adf5-12031c0a6ffe"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/09d5eba7-9f22-44d0-9540-5724a2fa2d73"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/9184d919-94e9-49ce-935d-2c1d9742510d"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/9bb27ad2-7978-4dbf-ad79-b4832a7c4a31"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/d0c46382-591d-4099-bf3c-72bb8ed42e40"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/515a0b61-cb5a-4026-8bb0-af01a74a54b7"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/5982fb78-f848-4628-963a-003dbd3c120e"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/4ba25311-a2fc-4c8c-ba6a-708323eb7476"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/e677e76c-daf2-4dbd-9da7-bbca7ba0a59b"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/d4060b33-d570-42f0-aa71-0611fb3d5792"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/ef8b649d-c035-40a2-97e3-7d8e7cf9a405"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/52748985-025f-47c0-ba60-6f42c284497c"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/64435e52-d4da-4444-8719-3458df27a56a"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/d51a8538-d479-4a09-b1f4-1eb26badea21"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/5e250661-f22f-4405-9955-106157dc7a70"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/832f4c6f-7807-44b8-8829-c63678f1f383"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/44069c3d-6a1c-4c5b-8508-b3ca86c1e7e1"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/9a440455-7d7e-4bbf-beaf-ec44b25fc1ea"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/34e0c3c5-359f-4f23-87f1-fd1796fefc56"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/b348cec4-abbe-49a0-adb5-ea230d55ea27"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/b3d30433-e5e6-4a0a-b32c-53ccf40c17f3"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/35f73683-b82b-46ef-b0b8-0d19499c9487"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/440d82bb-e622-4911-bcf4-6e76b6a10e94"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/c683dbdc-c969-45d4-98ec-a495587a8b21"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/a8cb668e-54ff-48c1-9ab0-dd6b1aefd1eb"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/6627201a-3244-42cf-bdf4-095c4630e0dd"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/8d998e66-d9c6-41ca-96e3-debc61f7a69a"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/d9acc670-6c4f-4854-ac1b-8f16f3136a4c"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/fecffe8f-0131-4258-a2e9-8d56b8cc91ba"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/3bc00f7f-2c11-4150-a52b-5c3494833723"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/e572d50e-f212-4ab5-8587-812cfa6be59a"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/237f2320-1c29-4304-b319-dfc689047f15"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/ca28d1cf-c96f-4ec5-960d-91582a5561e1"><meta property="og:image" content="http://blogfileqiniu.isjinhao.site/254a4352-87c0-483f-8221-0aa44e45520f"><meta property="og:updated_time" content="2019-12-30T13:20:35.721Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="03.02-JVM-字节码"><meta name="twitter:description" content="字节码文件结构使用javap-verbose命令分析一个字节码文件时将会分析该字节码文件的魔数、版本号、常量池、类信息、类的构造方法、类中的方法信息、类变量与成员变量等信息。我们先来编写一个非常简单的类。12public interface MyInterface1 &amp;#123;&amp;#125;反编译指令：javap，参数：-p、-verbose。12345public class MyTest1 i"><meta name="twitter:image" content="http://blogfileqiniu.isjinhao.site/ccc5f00c-1a6d-44a8-adf5-12031c0a6ffe"><link rel="alternate" href="/atom.xml" title="ISJINHAO" type="application/atom+xml"><link rel="canonical" href="https://isjinhao.github.io/posts/20964.html/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>03.02-JVM-字节码 | ISJINHAO</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">ISJINHAO</span> <span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-series"><a href="/series/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i><br>系列文章</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="algolia-popup popup search-popup"><div class="algolia-search"><div class="algolia-search-input-icon"><i class="fa fa-search"></i></div><div class="algolia-search-input" id="algolia-search-input"></div></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://isjinhao.github.io/posts/20964.html/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="ISJINHAO"><meta itemprop="description" content="Living & Working"><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ISJINHAO"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">03.02-JVM-字节码</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-12-30 21:20:19 / 修改时间：21:20:35" itemprop="dateCreated datePublished" datetime="2019-12-30T21:20:19+08:00">2019-12-30</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JVM/" itemprop="url" rel="index"><span itemprop="name">JVM</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span title="本文字数">23k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">20 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p><br></p><h2 id="字节码文件结构"><a href="#字节码文件结构" class="headerlink" title="字节码文件结构"></a>字节码文件结构</h2><p>使用<code>javap-verbose</code>命令分析一个字节码文件时将会分析该字节码文件的魔数、版本号、常量池、类信息、类的构造方法、类中的方法信息、类变量与成员变量等信息。我们先来编写一个非常简单的类。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyInterface1</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>反编译指令：<code>javap</code>，参数：<code>-p</code>、<code>-verbose</code>。<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest1</span> <span class="keyword">implements</span> <span class="title">MyInterface1</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String str = <span class="string">"1000"</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStr</span><span class="params">()</span> </span>&#123;	<span class="keyword">return</span> str;		&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStr</span><span class="params">(String str)</span> </span>&#123;	<span class="keyword">this</span>.str = str;	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">Classfile /D:/workspace/java/project-workspace/backend-development-summary/codes/target/classes/two/jvm/bytecodes/MyTest1.class</span><br><span class="line">  Last modified 2019-11-26; size 587 bytes</span><br><span class="line">  MD5 checksum a6fe9bd13568b3724178d222e01b213c</span><br><span class="line">  Compiled from &quot;MyTest1.java&quot;</span><br><span class="line">public class two.jvm.bytecodes.MyTest1 implements two.jvm.bytecodes.MyInterface1</span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: 52</span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #5.#22         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">   #2 = String             #23            // 1000</span><br><span class="line">   #3 = Fieldref           #4.#24         // two/jvm/bytecodes/MyTest1.str:Ljava/lang/String;</span><br><span class="line">   #4 = Class              #25            // two/jvm/bytecodes/MyTest1</span><br><span class="line">   #5 = Class              #26            // java/lang/Object</span><br><span class="line">   #6 = Class              #27            // two/jvm/bytecodes/MyInterface1</span><br><span class="line">   #7 = Utf8               str</span><br><span class="line">   #8 = Utf8               Ljava/lang/String;</span><br><span class="line">   #9 = Utf8               &lt;init&gt;</span><br><span class="line">  #10 = Utf8               ()V</span><br><span class="line">  #11 = Utf8               Code</span><br><span class="line">  #12 = Utf8               LineNumberTable</span><br><span class="line">  #13 = Utf8               LocalVariableTable</span><br><span class="line">  #14 = Utf8               this</span><br><span class="line">  #15 = Utf8               Ltwo/jvm/bytecodes/MyTest1;</span><br><span class="line">  #16 = Utf8               getStr</span><br><span class="line">  #17 = Utf8               ()Ljava/lang/String;</span><br><span class="line">  #18 = Utf8               setStr</span><br><span class="line">  #19 = Utf8               (Ljava/lang/String;)V</span><br><span class="line">  #20 = Utf8               SourceFile</span><br><span class="line">  #21 = Utf8               MyTest1.java</span><br><span class="line">  #22 = NameAndType        #9:#10         // &quot;&lt;init&gt;&quot;:()V</span><br><span class="line">  #23 = Utf8               1000</span><br><span class="line">  #24 = NameAndType        #7:#8          // str:Ljava/lang/String;</span><br><span class="line">  #25 = Utf8               two/jvm/bytecodes/MyTest1</span><br><span class="line">  #26 = Utf8               java/lang/Object</span><br><span class="line">  #27 = Utf8               two/jvm/bytecodes/MyInterface1</span><br><span class="line">&#123;</span><br><span class="line">  public two.jvm.bytecodes.MyTest1();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=2, locals=1, args_size=1</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">         4: aload_0</span><br><span class="line">         5: ldc           #2                  // String 1000</span><br><span class="line">         7: putfield      #3                  // Field str:Ljava/lang/String;</span><br><span class="line">        10: return</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 3: 0</span><br><span class="line">        line 5: 4</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0      11     0  this   Ltwo/jvm/bytecodes/MyTest1;</span><br><span class="line">  public java.lang.String getStr();</span><br><span class="line">    descriptor: ()Ljava/lang/String;</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=1, locals=1, args_size=1</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: getfield      #3                  // Field str:Ljava/lang/String;</span><br><span class="line">         4: areturn</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 8: 0</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0       5     0  this   Ltwo/jvm/bytecodes/MyTest1;</span><br><span class="line">  public void setStr(java.lang.String);</span><br><span class="line">    descriptor: (Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=2, locals=2, args_size=2</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: aload_1</span><br><span class="line">         2: putfield      #3                  // Field str:Ljava/lang/String;</span><br><span class="line">         5: return</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 12: 0</span><br><span class="line">        line 13: 5</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0       6     0  this   Ltwo/jvm/bytecodes/MyTest1;</span><br><span class="line">            0       6     1   str   Ljava/lang/String;</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: &quot;MyTest1.java&quot;</span><br></pre></td></tr></table></figure><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/ccc5f00c-1a6d-44a8-adf5-12031c0a6ffe"></div><p><br></p><h3 id="字节码文件解析"><a href="#字节码文件解析" class="headerlink" title="字节码文件解析"></a>字节码文件解析</h3><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/09d5eba7-9f22-44d0-9540-5724a2fa2d73"></div><h4 id="魔数-amp-版本号"><a href="#魔数-amp-版本号" class="headerlink" title="魔数 &amp; 版本号"></a><strong>魔数</strong> &amp; 版本号</h4><p><strong>魔数</strong></p><p>所有的class字节码文件的前4个字节都是魔数，魔数值为固定值：0xCAFEBABE。翻译为“咖啡宝贝”，emmm，和Java的图标有异曲同工之妙。</p><p><strong>版本号</strong></p><p>魔数之后的4个字节为版本信息，前两个字节表示<code>minor version（次版本号）</code>，后两个字节表示<code>major version（主版本号）</code>。这里的版本号为00000034，换算成十进制，表示次版本号为0，主版本号为52。所以，该文件的版本号为：1.8.0。可以通过<code>java-version</code>命令来查看当前JDK的版本。<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// JDK版本号与字节码文件版本号对应表</span><br><span class="line">J2SE 8 = 52</span><br><span class="line">J2SE 7 = 51</span><br><span class="line">J2SE 6.0 = 50</span><br><span class="line">J2SE 5.0 = 49</span><br><span class="line">JDK 1.4 = 48</span><br><span class="line">JDK 1.3 = 47</span><br><span class="line">JDK 1.2 = 46</span><br><span class="line">JDK 1.1 = 45</span><br></pre></td></tr></table></figure><p></p><h4 id="常量池（constant-pool）"><a href="#常量池（constant-pool）" class="headerlink" title="常量池（constant pool）"></a><strong>常量池（constant pool）</strong></h4><p>紧接着主版本号之后的就是常量池入口。一个Java类中定义的很多信息都是由常量池来维护和描述的，可以将常量池看作是class文件的资源仓库，比如说Java类中定义的方法与变量信息，都是存储在常量池中。常量池中主要存储两类常量：字面量与符号引用。字面量如文本字符串，Java中声明为final的常量值等，而符号引用如类和接口的全局限定名，字段的名称和描述符，方法的名称和描述符等。</p><h5 id="常量池的总体结构"><a href="#常量池的总体结构" class="headerlink" title="常量池的总体结构"></a><strong>常量池的总体结构</strong></h5><p>Java类所对应的常量池主要由常量池数量与常量池数组（常量表）这两部分共同构成。常量池数量紧跟在主版本号后面，占据2个字节。常量池数组则紧跟在常量池数量之后。值得注意的是：<code>常量池数组中元素的个数=常量池数-1</code>，目的是满足某些常量池索引值的数据在特定情况下需要表达不引用任何一个常量池的含义，也就是说索引为0的位置也是一个常量（保留常量），只不过它不位于常量表中，这个常量就对应null值。如我们上面的示例中，001C表示有28个常量，常量池中有27个常量，加上一个null，正好是28个。<br>常量池数组与一般的数组不同的是，常量池数组中不同的元素的类型、结构都是不同的，长度当然也就不同；但是，每一种元素的第一个数据都是一个u1类型，该字节是个标志位，占据1个字节。JVM在解析常量池时，会根据这个u1类型来获取元素的具体类型。</p><div align="center"><img width="95%" src="http://blogfileqiniu.isjinhao.site/9184d919-94e9-49ce-935d-2c1d9742510d"></div><p>在JVM规范中，每个变量/字段都有描述信息，描述信息主要的作用是描述字段的数据类型、方法的参数列表（包括数量、类型与顺序）与返回值。根据描述符规则，基本数据类型和代表无返回值的void类型都用一个<code>大写字符</code>来表示，对象类型则使用<code>字符L加对象的全限定名称</code>来表示。目的是压缩字节码文件的体积，如下：<code>B-byte</code>、<code>C-char</code>、<code>D-double</code>、<code>F-float</code>、<code>I-int</code>、<code>J-long</code>、<code>S-short</code>、<code>Z-boolean</code>、<code>V-void</code>、<code>L-对象类型</code>，如<br><code>Ljava/lang/String;</code>。<br>对于数组类型来说，每一个维度使用一个前置的<code>[</code>来表示，如<code>int[</code>被记录为<code>[</code>，<code>String[[</code>被记录为<code>[Ljava/lang/string</code>。</p><p><strong>描述方法</strong></p><p>用描述符描述方法时，按照先参数列表，后返回值的顺序来描述。参数列表按照参数的严格顺序放在一组<code>()</code>内，如方法 <code>String getRealNameByIdAndNickNName(int id, String name);</code>的描述符为：<code>(I, Ljava/lang/String;)Ljava/lang/String;</code>。</p><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/9bb27ad2-7978-4dbf-ad79-b4832a7c4a31"></div><p><strong>描述属性</strong></p><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/d0c46382-591d-4099-bf3c-72bb8ed42e40"></div><h4 id="类访问标志-amp-父类-amp-接口"><a href="#类访问标志-amp-父类-amp-接口" class="headerlink" title="类访问标志&amp;父类&amp;接口"></a>类访问标志&amp;父类&amp;接口</h4><p><strong>access flags</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/515a0b61-cb5a-4026-8bb0-af01a74a54b7"></div><p>access flags中一共有16个标志位可以使用，当前只定义了其中8个，没有使用到的标志位要求一律为0。我们的代码是一个普通Java类，不是接口、枚举或者注解，被public关键字修饰但没有被声明为final和abstract，并且它使用了JDK1.2之后的编译器进行编译，因此它的ACC_PUBLIC、 ACC_SUPER标志应当为真，而ACC_FINAL、ACC_INTERFACE、ACC_ABSTRACT、ACC_SYNTHETIC、ACC_ANNOTATION、ACC_ENUM这6个标志应当为假，因此它的access flags的值应为:0x0001 &amp; 0x0020 = 0x0021。16进制显示也确实如此。</p><p><strong>当前类名 &amp; 父类名</strong></p><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/5982fb78-f848-4628-963a-003dbd3c120e"></div><p><strong>接口个数 &amp; 接口名</strong></p><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/4ba25311-a2fc-4c8c-ba6a-708323eb7476"></div><h4 id="字段表集合"><a href="#字段表集合" class="headerlink" title="字段表集合"></a>字段表集合</h4><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/e677e76c-daf2-4dbd-9da7-bbca7ba0a59b"></div><p><strong>字段访问标志</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/d4060b33-d570-42f0-aa71-0611fb3d5792"></div><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/ef8b649d-c035-40a2-97e3-7d8e7cf9a405"></div><h4 id="方法表集合"><a href="#方法表集合" class="headerlink" title="方法表集合"></a>方法表集合</h4><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/52748985-025f-47c0-ba60-6f42c284497c"></div><p><strong>方法访问标志</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/64435e52-d4da-4444-8719-3458df27a56a"></div><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/d51a8538-d479-4a09-b1f4-1eb26badea21"></div><h4 id="属性表集合"><a href="#属性表集合" class="headerlink" title="属性表集合"></a>属性表集合</h4><p>属性表（attribute_info）在前面的讲解之中已经出现过数次，在Class、字段表方法表都可以携带自己的属性表集合，以用于描述某些场景专有的信息与Class文件中其他的数据项目要求严格的顺序、长度和内容不同，属性表集合的限制稍微宽松了一些。不再要求各个属性表具有严格顺序，并且只要不与已有属性名重复，任何人实现的编译器都可以向属性表中写入自己定义的属性信息。下面是属性表名称及其对应的位置。</p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/5e250661-f22f-4405-9955-106157dc7a70"></div><p><strong>Code属性</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/832f4c6f-7807-44b8-8829-c63678f1f383"></div><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/44069c3d-6a1c-4c5b-8508-b3ca86c1e7e1"></div><p><strong>LineNumberTable属性</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/9a440455-7d7e-4bbf-beaf-ec44b25fc1ea"></div><p>line_number_table是一个数量为 line_number_table_length、类型为 line_number_info的集合，line_number_info表包括了 start_pc 和 line_number两个u2类型的数据项，前者是字节码行号，后者是Java源码行号。</p><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/34e0c3c5-359f-4f23-87f1-fd1796fefc56"></div><p><strong>LocalVariableTable</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/b348cec4-abbe-49a0-adb5-ea230d55ea27"></div><p>其中，local_variable_info项目代表了一个栈帧与源码中的局部变量的关联。</p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/b3d30433-e5e6-4a0a-b32c-53ccf40c17f3"></div><p>start_pc和 length属性分别代表这个局部变量的生命周期开始的字节码偏移量及其作用范围覆盖的长度，两者结合起来就是这个局部变量在字节码之中的作用域范围。name_index和 descriptor_index都是指向常量池中 CONSTANT_Utf8_info型常量的索引，分别代表了局部变量的名称以及这个局部变量的描述符。index是这个局部变量在栈帧局部变量表中slot的位置。当这个变量数据类型是64位类型时（double和long），它占用的Slot为 index 和 index+1两个。</p><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/35f73683-b82b-46ef-b0b8-0d19499c9487"></div><p><strong>ConstantValue属性</strong></p><p>Constant Value属性的作用是通知虚拟机自动为静态变量赋值。只有被 static 关键字修饰的变量（类变量）才可以使用这项属性。类似“int x=123”和“static int=123”这样的变量定义在Java程序中是非常常见的事情，但虚拟机对这两种变量赋值的方式和时刻都有所不同。对手非 static 类型的变量（也就是实例变量）的赋值是在实例构造器<code>&lt;init&gt;</code>方法中进行的；而对于类变量则有两种方式可以选择：在类构造器<code>&lt;clini&gt;</code>方法中或者使用 Constant Value属性。目前 Sun Java 编译器的选择是：如果同时使用 fina l和 static 来修饰一个变量（按照习惯，这里称“常量”更贴切），并且这个变量的数据类型是基本类型或者 java.lang.String的话，就生成 Constant Value 属性来进行初始化，如果这个变量没有被 final 修饰，或者非基本类型及字符串，则将会选择在<code>&lt;ckinit&gt;</code>方法中进行初始化。<br>虽然有 final 关键字才更符合“Constant Value”的语义，但虚拟机规范中并没有强制要求字段必须设置了 ACC_FINAL标志只要求了有 Constant Value 属性的字段必须设置 ACC_STATIC 标志而已，对 final 关键字的要求是 Javac编译器自己加入的限制。而对 Constant Value 的属性值只能限于基本类型和 String，不过其实这不是什么限制，因为此属性的属性值只是一个常量池的索引号，由于 Class 文件格式的常量类型中只有与基本属性和字符串相对应的字面量，所以就算 Constant Value 属性想支持别的类型也无能为力。<br>从数据结构中可以看出， Constant Value 属性是一个定长属性，它的 attribute_length 数据项值必须固定为2。 constantvalue_index 数据项代表了常量池中一个字面量常量的引用，根据字段类型的不同，字面量可以是 CONSTANT_Long_info、 CONSTANT_Float_info、CONSTANT_Double_info、 CONSTANT_Integer_info、CONSTANT_ String_info常量中的一种。</p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/440d82bb-e622-4911-bcf4-6e76b6a10e94"></div><h4 id="SourceFile属性"><a href="#SourceFile属性" class="headerlink" title="SourceFile属性"></a>SourceFile属性</h4><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/c683dbdc-c969-45d4-98ec-a495587a8b21"></div><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/a8cb668e-54ff-48c1-9ab0-dd6b1aefd1eb"></div><p><br></p><h2 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a>实例分析</h2><h3 id="静态代码块"><a href="#静态代码块" class="headerlink" title="静态代码块"></a>静态代码块</h3><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/6627201a-3244-42cf-bdf4-095c4630e0dd"></div><p>静态属性的初始化和静态代码块的执行都是在JDK自动生成的<code>cinit</code>方法中完成的。其实是指令重排序的体现。</p><p><br></p><h3 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h3><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/8d998e66-d9c6-41ca-96e3-debc61f7a69a"></div><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/d9acc670-6c4f-4854-ac1b-8f16f3136a4c"></div><p>实例变量的赋值本质上都是在构造方法里进行的。</p><p><br></p><h3 id="分析异常"><a href="#分析异常" class="headerlink" title="分析异常"></a>分析异常</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ArrayIndexOutOfBoundsException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        InputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"test.txt"</span>);</span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">        serverSocket.accept();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NullPointerException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"finally"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        test();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">Classfile /D:/workspace/java/project-workspace/backend-development-summary/codes/target/classes/two/jvm/bytecodes/MyTest4.class</span><br><span class="line">  Last modified 2019-11-28; size 1347 bytes</span><br><span class="line">  MD5 checksum d2e6f4cb6a617878f8c9757b8cc2c6e6</span><br><span class="line">  Compiled from &quot;MyTest4.java&quot;</span><br><span class="line">public class two.jvm.bytecodes.MyTest4</span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: 52</span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #16.#45        // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">   #2 = Class              #46            // java/io/FileInputStream</span><br><span class="line">   #3 = String             #47            // test.txt</span><br><span class="line">   #4 = Methodref          #2.#48         // java/io/FileInputStream.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span><br><span class="line">   #5 = Class              #49            // java/net/ServerSocket</span><br><span class="line">   #6 = Methodref          #5.#50         // java/net/ServerSocket.&quot;&lt;init&gt;&quot;:(I)V</span><br><span class="line">   #7 = Methodref          #5.#51         // java/net/ServerSocket.accept:()Ljava/net/Socket;</span><br><span class="line">   #8 = Fieldref           #52.#53        // java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">   #9 = String             #54            // finally</span><br><span class="line">  #10 = Methodref          #55.#56        // java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">  #11 = Class              #57            // java/io/FileNotFoundException</span><br><span class="line">  #12 = Class              #58            // java/lang/NullPointerException</span><br><span class="line">  #13 = Methodref          #15.#59        // two/jvm/bytecodes/MyTest4.test:()V</span><br><span class="line">  #14 = Class              #60            // java/io/IOException</span><br><span class="line">  #15 = Class              #61            // two/jvm/bytecodes/MyTest4</span><br><span class="line">  #16 = Class              #62            // java/lang/Object</span><br><span class="line">  #17 = Utf8               &lt;init&gt;</span><br><span class="line">  #18 = Utf8               ()V</span><br><span class="line">  #19 = Utf8               Code</span><br><span class="line">  #20 = Utf8               LineNumberTable</span><br><span class="line">  #21 = Utf8               LocalVariableTable</span><br><span class="line">  #22 = Utf8               this</span><br><span class="line">  #23 = Utf8               Ltwo/jvm/bytecodes/MyTest4;</span><br><span class="line">  #24 = Utf8               test</span><br><span class="line">  #25 = Utf8               inputStream</span><br><span class="line">  #26 = Utf8               Ljava/io/InputStream;</span><br><span class="line">  #27 = Utf8               serverSocket</span><br><span class="line">  #28 = Utf8               Ljava/net/ServerSocket;</span><br><span class="line">  #29 = Utf8               ex</span><br><span class="line">  #30 = Utf8               Ljava/io/FileNotFoundException;</span><br><span class="line">  #31 = Utf8               Ljava/lang/NullPointerException;</span><br><span class="line">  #32 = Utf8               StackMapTable</span><br><span class="line">  #33 = Class              #57            // java/io/FileNotFoundException</span><br><span class="line">  #34 = Class              #58            // java/lang/NullPointerException</span><br><span class="line">  #35 = Class              #63            // java/lang/Throwable</span><br><span class="line">  #36 = Utf8               Exceptions</span><br><span class="line">  #37 = Class              #64            // java/lang/ArrayIndexOutOfBoundsException</span><br><span class="line">  #38 = Utf8               main</span><br><span class="line">  #39 = Utf8               ([Ljava/lang/String;)V</span><br><span class="line">  #40 = Utf8               args</span><br><span class="line">  #41 = Utf8               [Ljava/lang/String;</span><br><span class="line">  #42 = Class              #60            // java/io/IOException</span><br><span class="line">  #43 = Utf8               SourceFile</span><br><span class="line">  #44 = Utf8               MyTest4.java</span><br><span class="line">  #45 = NameAndType        #17:#18        // &quot;&lt;init&gt;&quot;:()V</span><br><span class="line">  #46 = Utf8               java/io/FileInputStream</span><br><span class="line">  #47 = Utf8               test.txt</span><br><span class="line">  #48 = NameAndType        #17:#65        // &quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span><br><span class="line">  #49 = Utf8               java/net/ServerSocket</span><br><span class="line">  #50 = NameAndType        #17:#66        // &quot;&lt;init&gt;&quot;:(I)V</span><br><span class="line">  #51 = NameAndType        #67:#68        // accept:()Ljava/net/Socket;</span><br><span class="line">  #52 = Class              #69            // java/lang/System</span><br><span class="line">  #53 = NameAndType        #70:#71        // out:Ljava/io/PrintStream;</span><br><span class="line">  #54 = Utf8               finally</span><br><span class="line">  #55 = Class              #72            // java/io/PrintStream</span><br><span class="line">  #56 = NameAndType        #73:#65        // println:(Ljava/lang/String;)V</span><br><span class="line">  #57 = Utf8               java/io/FileNotFoundException</span><br><span class="line">  #58 = Utf8               java/lang/NullPointerException</span><br><span class="line">  #59 = NameAndType        #24:#18        // test:()V</span><br><span class="line">  #60 = Utf8               java/io/IOException</span><br><span class="line">  #61 = Utf8               two/jvm/bytecodes/MyTest4</span><br><span class="line">  #62 = Utf8               java/lang/Object</span><br><span class="line">  #63 = Utf8               java/lang/Throwable</span><br><span class="line">  #64 = Utf8               java/lang/ArrayIndexOutOfBoundsException</span><br><span class="line">  #65 = Utf8               (Ljava/lang/String;)V</span><br><span class="line">  #66 = Utf8               (I)V</span><br><span class="line">  #67 = Utf8               accept</span><br><span class="line">  #68 = Utf8               ()Ljava/net/Socket;</span><br><span class="line">  #69 = Utf8               java/lang/System</span><br><span class="line">  #70 = Utf8               out</span><br><span class="line">  #71 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #72 = Utf8               java/io/PrintStream</span><br><span class="line">  #73 = Utf8               println</span><br><span class="line">&#123;</span><br><span class="line">  public two.jvm.bytecodes.MyTest4();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=1, locals=1, args_size=1</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">         4: return</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 9: 0</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0       5     0  this   Ltwo/jvm/bytecodes/MyTest4;</span><br><span class="line">  public static void test() throws java.io.IOException, java.lang.ArrayIndexOutOfBoundsException;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=3, locals=3, args_size=0</span><br><span class="line">         0: new           #2                  // class java/io/FileInputStream</span><br><span class="line">         3: dup</span><br><span class="line">         4: ldc           #3                  // String test.txt</span><br><span class="line">         6: invokespecial #4                  // Method java/io/FileInputStream.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span><br><span class="line">         9: astore_0</span><br><span class="line">        10: new           #5                  // class java/net/ServerSocket</span><br><span class="line">        13: dup</span><br><span class="line">        14: sipush        9999</span><br><span class="line">        17: invokespecial #6                  // Method java/net/ServerSocket.&quot;&lt;init&gt;&quot;:(I)V</span><br><span class="line">        20: astore_1</span><br><span class="line">        21: aload_1</span><br><span class="line">        22: invokevirtual #7                  // Method java/net/ServerSocket.accept:()Ljava/net/Socket;</span><br><span class="line">        25: pop</span><br><span class="line">        26: getstatic     #8                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        29: ldc           #9                  // String finally</span><br><span class="line">        31: invokevirtual #10                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">        34: goto          54</span><br><span class="line">        37: astore_0</span><br><span class="line">        38: aload_0</span><br><span class="line">        39: athrow</span><br><span class="line">        40: astore_0</span><br><span class="line">        41: aload_0</span><br><span class="line">        42: athrow</span><br><span class="line">        43: astore_2</span><br><span class="line">        44: getstatic     #8                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        47: ldc           #9                  // String finally</span><br><span class="line">        49: invokevirtual #10                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">        52: aload_2</span><br><span class="line">        53: athrow</span><br><span class="line">        54: return</span><br><span class="line">      Exception table:</span><br><span class="line">         from    to  target type</span><br><span class="line">             0    26    37   Class java/io/FileNotFoundException</span><br><span class="line">             0    26    40   Class java/lang/NullPointerException</span><br><span class="line">             0    26    43   any</span><br><span class="line">            37    44    43   any</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 13: 0</span><br><span class="line">        line 14: 10</span><br><span class="line">        line 15: 21</span><br><span class="line">        line 21: 26</span><br><span class="line">        line 22: 34</span><br><span class="line">        line 16: 37</span><br><span class="line">        line 17: 38</span><br><span class="line">        line 18: 40</span><br><span class="line">        line 19: 41</span><br><span class="line">        line 21: 43</span><br><span class="line">        line 22: 52</span><br><span class="line">        line 23: 54</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">           10      16     0 inputStream   Ljava/io/InputStream;</span><br><span class="line">           21       5     1 serverSocket   Ljava/net/ServerSocket;</span><br><span class="line">           38       2     0    ex   Ljava/io/FileNotFoundException;</span><br><span class="line">           41       2     0    ex   Ljava/lang/NullPointerException;</span><br><span class="line">      StackMapTable: number_of_entries = 4</span><br><span class="line">        frame_type = 101 /* same_locals_1_stack_item */</span><br><span class="line">          stack = [ class java/io/FileNotFoundException ]</span><br><span class="line">        frame_type = 66 /* same_locals_1_stack_item */</span><br><span class="line">          stack = [ class java/lang/NullPointerException ]</span><br><span class="line">        frame_type = 66 /* same_locals_1_stack_item */</span><br><span class="line">          stack = [ class java/lang/Throwable ]</span><br><span class="line">        frame_type = 10 /* same */</span><br><span class="line">    Exceptions:</span><br><span class="line">      throws java.io.IOException, java.lang.ArrayIndexOutOfBoundsException</span><br><span class="line">  public static void main(java.lang.String[]);</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=1, locals=2, args_size=1</span><br><span class="line">         0: invokestatic  #13                 // Method test:()V</span><br><span class="line">         3: goto          7</span><br><span class="line">         6: astore_1</span><br><span class="line">         7: return</span><br><span class="line">      Exception table:</span><br><span class="line">         from    to  target type</span><br><span class="line">             0     3     6   Class java/io/IOException</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 27: 0</span><br><span class="line">        line 30: 3</span><br><span class="line">        line 28: 6</span><br><span class="line">        line 31: 7</span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            0       8     0  args   [Ljava/lang/String;</span><br><span class="line">      StackMapTable: number_of_entries = 2</span><br><span class="line">        frame_type = 70 /* same_locals_1_stack_item */</span><br><span class="line">          stack = [ class java/io/IOException ]</span><br><span class="line">        frame_type = 0 /* same */</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: &quot;MyTest4.java&quot;</span><br></pre></td></tr></table></figure><p>从字节码的角度是不区分受查异常和非受查异常的，但是区分try-catch异常处理和throws的异常处理。而对于<code>throw new Exception()</code>语法来说，仅仅是抛出了一个异常，需要调用者接收。</p><p><strong>Exceptions属性</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/fecffe8f-0131-4258-a2e9-8d56b8cc91ba"></div><p>Exceptions属性是在方法表中与Code属性平级的一项属性，作用是列举出方法中可能抛出的受查异常（Checked Excepitons），也就是方法描述时在 throws 关键字后面列举的异常。结构如上表。</p><p><strong>exception_index_table</strong></p><p>Exceptions属性中的 number_of_exceptions项表示方法可能抛出 number_of_exceptions 种受查异常，每一种受查异常使用一个exception_index_table项表示，exception_index_table是一个指向常量池中 CONSTANT_Class_info 型常量的索引，代表了该受查异常的类型。</p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/3bc00f7f-2c11-4150-a52b-5c3494833723"></div><p><strong>exception_table</strong></p><p>exception_table是存在Code属性中的，也是try_catch在字节码层次的体现。</p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/e572d50e-f212-4ab5-8587-812cfa6be59a"></div><p>如果当字节码在第 start_pc 行到第 end_pc 行之间（不含第 end 行出现了类型为 catch_type或者其子类的异常（catch_type）为指向一个 CONSTANF_Classinfo 型常量的索引，则转到第 handler_pc 行继续处理。当 catch_type的值为0时，代表任意异常情况都需要转向到 handler_pc 处进行处理。<br>使用jclasslib分析上面的异常：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> 0 new #2 &lt;java/io/FileInputStream&gt;</span><br><span class="line"> 3 dup</span><br><span class="line"> 4 ldc #3 &lt;test.txt&gt;</span><br><span class="line"> 6 invokespecial #4 &lt;java/io/FileInputStream.&lt;init&gt;&gt;</span><br><span class="line"> 9 astore_0</span><br><span class="line">10 new #5 &lt;java/net/ServerSocket&gt;</span><br><span class="line">13 dup</span><br><span class="line">14 sipush 9999</span><br><span class="line">17 invokespecial #6 &lt;java/net/ServerSocket.&lt;init&gt;&gt;</span><br><span class="line">20 astore_1</span><br><span class="line">21 aload_1</span><br><span class="line">22 invokevirtual #7 &lt;java/net/ServerSocket.accept&gt;</span><br><span class="line">25 pop</span><br><span class="line">26 getstatic #8 &lt;java/lang/System.out&gt;</span><br><span class="line">29 ldc #9 &lt;finally&gt;</span><br><span class="line">31 invokevirtual #10 &lt;java/io/PrintStream.println&gt;</span><br><span class="line">34 goto 54 (+20)</span><br><span class="line">37 astore_0</span><br><span class="line">38 aload_0</span><br><span class="line">39 athrow</span><br><span class="line">40 astore_0</span><br><span class="line">41 aload_0</span><br><span class="line">42 athrow</span><br><span class="line">43 astore_2</span><br><span class="line">44 getstatic #8 &lt;java/lang/System.out&gt;</span><br><span class="line">47 ldc #9 &lt;finally&gt;</span><br><span class="line">49 invokevirtual #10 &lt;java/io/PrintStream.println&gt;</span><br><span class="line">52 aload_2</span><br><span class="line">53 athrow</span><br><span class="line">54 return</span><br></pre></td></tr></table></figure><p></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/237f2320-1c29-4304-b319-dfc689047f15"></div><p>从上面反编译的助记符可以知道，finally的处理是在每个 catch 后面复制一份finally里面的指令来完成的。</p><p><br></p><h3 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (o)&#123;</span><br><span class="line">        System.out.println(o);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags:</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">3</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         1: getfield      #3     // Field o:Ljava/lang/Object;</span><br><span class="line">         <span class="number">4</span>: dup</span><br><span class="line">         <span class="number">5</span>: astore_1</span><br><span class="line">         <span class="number">6</span>: monitorenter			<span class="comment">// 加锁</span></span><br><span class="line">         7: getstatic     #4     // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        <span class="number">10</span>: aload_0</span><br><span class="line">        11: getfield      #3     // Field o:Ljava/lang/Object;</span><br><span class="line">        14: invokevirtual #5     // Method java/io/PrintStream.println:(Ljava/lang/Object;)V</span><br><span class="line">        <span class="number">17</span>: aload_1</span><br><span class="line">        <span class="number">18</span>: monitorexit				<span class="comment">// 正常解锁</span></span><br><span class="line">        <span class="number">19</span>: goto          <span class="number">27</span>		<span class="comment">// 正常解锁之后return</span></span><br><span class="line">        <span class="number">22</span>: astore_2</span><br><span class="line">        <span class="number">23</span>: aload_1</span><br><span class="line">        <span class="number">24</span>: monitorexit				<span class="comment">// 保证在athrow之前锁被释放</span></span><br><span class="line">        <span class="number">25</span>: aload_2</span><br><span class="line">        <span class="number">26</span>: athrow</span><br><span class="line">        <span class="number">27</span>: <span class="keyword">return</span></span><br><span class="line">      Exception table:</span><br><span class="line">         from    to  target type</span><br><span class="line">             <span class="number">7</span>    <span class="number">19</span>    <span class="number">22</span>   any</span><br><span class="line">            <span class="number">22</span>    <span class="number">25</span>    <span class="number">22</span>   any</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">16</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">17</span>: <span class="number">7</span></span><br><span class="line">        line <span class="number">18</span>: <span class="number">17</span></span><br><span class="line">        line <span class="number">19</span>: <span class="number">27</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>      <span class="number">28</span>     <span class="number">0</span>  <span class="keyword">this</span>   Ltwo/jvm/bytecodes/MyTest2;</span><br><span class="line">      StackMapTable: number_of_entries = <span class="number">2</span></span><br><span class="line">        frame_type = <span class="number">255</span> <span class="comment">/* full_frame */</span></span><br><span class="line">          offset_delta = <span class="number">22</span></span><br><span class="line">          locals = [ class two/jvm/bytecodes/MyTest2, class java/lang/Object ]</span><br><span class="line">          stack = [ class java/lang/Throwable ]</span><br><span class="line">        frame_type = <span class="number">250</span> <span class="comment">/* chop */</span></span><br><span class="line">          offset_delta = <span class="number">4</span></span><br></pre></td></tr></table></figure><p><strong>异常时退出的处理</strong></p><div align="center"><img width="80%" src="http://blogfileqiniu.isjinhao.site/ca28d1cf-c96f-4ec5-960d-91582a5561e1"></div><p>如果[7, 19)行的任何异常转到22行，[22, 25)行的任何异常转到22行。</p><p><strong>monitorenter</strong></p><p>The <em>objectref</em> must be of type <code>reference</code>.<br>Each object is associated with a monitor. A monitor is locked if and only if it has an owner. The thread that executes <em>monitorenter</em> attempts to gain ownership of the monitor associated with <em>objectref</em>, as follows:</p><ul><li>If the entry count of the monitor associated with <em>objectref</em> is zero, the thread enters the monitor and sets its entry count to one. The thread is then the owner of the monitor.</li><li>If the thread already owns the monitor associated with <em>objectref</em>, it reenters the monitor, incrementing its entry count.</li><li>If another thread already owns the monitor associated with <em>objectref</em>, the thread blocks until the monitor’s entry count is zero, then tries again to gain ownership.<br>Run-time Exceptions</li><li>If <em>objectref</em> is <code>null</code>, monitorenter throws a <code>NullPointerException</code><strong>.</strong></li></ul><p><strong>monitorexit</strong></p><ul><li>The <em>objectref</em> must be of type <code>reference</code>.</li><li>The thread that executes <em>monitorexit</em> must be the owner of the monitor associated with the instance referenced by <em>objectref</em>.</li><li>The thread decrements the entry count of the monitor associated with <em>objectref</em>. If as a result the value of the entry count is zero, the thread exits the monitor and is no longer its owner. Other threads that are blocking to enter the monitor are allowed to attempt to do so.<br>Run-time Exceptions</li><li>If <em>objectref</em> is <code>null</code>, <em>monitorexit</em> throws a <code>NullPointerException</code>.</li><li>Otherwise, if the thread that executes <em>monitorexit</em> is not the owner of the monitor associated with the instance referenced by <em>objectref</em>, <em>monitorexit</em> throws an <code>IllegalMonitorStateException</code>.</li><li>Otherwise, if the Java Virtual Machine implementation enforces the rules on structured locking described in <a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.11.10">§2.11.10</a> and if the second of those rules is violated by the execution of this <em>monitorexit</em> instruction, then <em>monitorexit</em> throws an <code>IllegalMonitorStateException</code>.</li></ul><p><br></p><h3 id="分析this"><a href="#分析this" class="headerlink" title="分析this"></a>分析this</h3><div align="center"><img width="100%" src="http://blogfileqiniu.isjinhao.site/254a4352-87c0-483f-8221-0aa44e45520f"></div><p>对于Java类中的每一个实例方法（非static方法），其在编译后所生成的字节码当中，方法参数的数量总是会比源代码中方法参数的数量多一个，即参数this，它位于方法的第一个参数位置处；这样，我们就可以在Java的实例方法中使用this来去访问当前对象的属性以及其他方法。<br>这个操作是在编译期间完成的，即由 javac 编译器在编译的时候将对this的访问转化为对一个普通实例方法参数的访问;接下来在运行期间。由JVM在调用实例方法时，自动向实例方法传入该this。所以在实例方法的局部变量表中，至少会有一个指向当前对象的局部变量。</p><p><strong>上图的4个局部变量</strong></p><ul><li>this</li><li>inputStream</li><li>serverSocket</li><li>第四个局部变量是两个catch中的某一个异常。因为两个异常最多只能有一个生效，所以局部变量最多是4个。</li></ul></div><div><div><div style="text-align:center;color:#ccc;font-size:14px;margin-top:30px">如果您有好的建议，欢迎在评论区或DaoVoice与我联系</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div></div><button id="rewardButton" disable="enable" onclick='var e=document.getElementById("QR");"none"===e.style.display?e.style.display="block":e.style.display="none"'><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/weichatpay.png" alt="ISJINHAO 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/images/alipay.jpg" alt="ISJINHAO 支付宝"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Java/" rel="tag"># Java</a> <a href="/tags/JVM/" rel="tag"># JVM</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/11515.html/" rel="next" title="03.03-JVM-解释执行"><i class="fa fa-chevron-left"></i> 03.03-JVM-解释执行</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/posts/35597.html/" rel="prev" title="03.01-JVM-类加载机制">03.01-JVM-类加载机制 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div class="comments" id="gitalk-container"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="ISJINHAO"><p class="site-author-name" itemprop="name">ISJINHAO</p><p class="site-description motion-element" itemprop="description">Living & Working</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">41</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/isjinhao" title="GitHub &rarr; https://github.com/isjinhao" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:isjinhao@163.com" title="E-Mail &rarr; mailto:isjinhao@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#字节码文件结构"><span class="nav-number">1.</span> <span class="nav-text">字节码文件结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#字节码文件解析"><span class="nav-number">1.1.</span> <span class="nav-text">字节码文件解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#魔数-amp-版本号"><span class="nav-number">1.1.1.</span> <span class="nav-text">魔数 &amp; 版本号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#常量池（constant-pool）"><span class="nav-number">1.1.2.</span> <span class="nav-text">常量池（constant pool）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#常量池的总体结构"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">常量池的总体结构</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#类访问标志-amp-父类-amp-接口"><span class="nav-number">1.1.3.</span> <span class="nav-text">类访问标志&amp;父类&amp;接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字段表集合"><span class="nav-number">1.1.4.</span> <span class="nav-text">字段表集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方法表集合"><span class="nav-number">1.1.5.</span> <span class="nav-text">方法表集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#属性表集合"><span class="nav-number">1.1.6.</span> <span class="nav-text">属性表集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SourceFile属性"><span class="nav-number">1.1.7.</span> <span class="nav-text">SourceFile属性</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实例分析"><span class="nav-number">2.</span> <span class="nav-text">实例分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#静态代码块"><span class="nav-number">2.1.</span> <span class="nav-text">静态代码块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构造方法"><span class="nav-number">2.2.</span> <span class="nav-text">构造方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分析异常"><span class="nav-number">2.3.</span> <span class="nav-text">分析异常</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#synchronized"><span class="nav-number">2.4.</span> <span class="nav-text">synchronized</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分析this"><span class="nav-number">2.5.</span> <span class="nav-text">分析this</span></a></li></ol></li></ol></div></div></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span> <span class="with-love" id="animate"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">ISJINHAO</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">670k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">10:09</span></div><div class="powered-by"><i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv"> 本站访客数：<span id="busuanzi_value_site_uv"></span></span></div><div class="theme-info"><div class="powered-by"></div><span class="post-count">| 博客全站共246.2k字</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/src/utils.js?v=6.7.0"></script><script src="/js/src/motion.js?v=6.7.0"></script><script src="/js/src/schemes/muse.js?v=6.7.0"></script><script src="/js/src/scrollspy.js?v=6.7.0"></script><script src="/js/src/post-details.js?v=6.7.0"></script><script src="/js/src/bootstrap.js?v=6.7.0"></script><script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script><script>var gitalk=new Gitalk({clientID:"cf0688d8364fa36ac889",clientSecret:"d9ae8a6b41055b558363130d6e6e7f7e78e2b7b8",repo:"isjinhao.github.io",owner:"isjinhao",admin:["isjinhao"],id:md5(location.pathname),distractionFreeMode:"true"});gitalk.render("gitalk-container")</script><script>function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var e=$("#local-search-input");e.attr("autocapitalize","none"),e.attr("autocorrect","off"),e.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(e){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(e,t,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:e,dataType:isXml?"xml":"json",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():e,r=document.getElementById(t),s=document.getElementById(o),a=function(){var e=r.value.trim().toLowerCase(),t=e.split(/[\s\-]+/);t.length>1&&t.push(e);var o=[];if(e.length>0&&n.forEach(function(n){function r(t,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===e&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(e,t){var o="",n=t.start;return t.hits.forEach(function(t){o+=e.substring(n,t.position);var r=t.position+t.length;o+='<b class="search-keyword">'+e.substring(t.position,r)+"</b>",n=r}),o+=e.substring(n,t.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url).replace(/\/{2,}/g,"/"),d=[],g=[];if(""!=l&&(t.forEach(function(e){function t(e,t,o){var n=e.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(t=t.toLowerCase(),e=e.toLowerCase());(s=t.indexOf(e,r))>-1;)a.push({position:s,word:e}),r=s+n;return a}d=d.concat(t(e,h,!1)),g=g.concat(t(e,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(e){e.sort(function(e,t){return t.position!==e.position?t.position-e.position:e.word.length-t.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hits.length!==t.hits.length?t.hits.length-e.hits.length:e.start-t.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(e){b+="<a href='"+f+'\'><p class="search-result">'+s(p,e)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===t.length&&""===t[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x"></i></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>';else{o.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id});var a='<ul class="search-result-list">';o.forEach(function(e){a+=e.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(e){e.stopPropagation()}),$(document).on("keyup",function(e){var t=27===e.which&&$(".search-popup").is(":visible");t&&onPopupClose()})</script><link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css"><script src="/lib/algolia-instant-search/instantsearch.min.js"></script><script src="/js/src/algolia-search.js?v=6.7.0"></script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      
      equationNumbers: {
        autoNumber: "AMS"
      }
    }
  });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
      for (i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });</script><script src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><style>.MathJax_Display{overflow:auto hidden}</style></body></html><!-- rebuild by neat -->